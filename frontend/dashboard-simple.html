<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Simple - Prueba</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 40px; 
            background: #f5f5f5; 
        }
        .container { 
            background: white; 
            padding: 30px; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { color: #2563eb; }
        .user-info { 
            background: #e6f3ff; 
            padding: 15px; 
            border-radius: 5px; 
            margin: 20px 0; 
        }
        .btn { 
            background: #2563eb; 
            color: white; 
            padding: 10px 20px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
        }
        .btn:hover { background: #1d4ed8; }
        .debug { 
            background: #f0f0f0; 
            padding: 15px; 
            border-radius: 5px; 
            margin: 20px 0; 
            font-family: monospace; 
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🎉 ¡Dashboard Cargado Exitosamente!</h1>
        
        <div class="user-info">
            <h3>Información del Usuario:</h3>
            <p><strong>Nombre:</strong> <span id="userName">Cargando...</span></p>
            <p><strong>Email:</strong> <span id="userEmail">Cargando...</span></p>
            <p><strong>Tipo:</strong> <span id="userType">Cargando...</span></p>
        </div>
        
        <div class="debug">
            <h4>Debug Info:</h4>
            <div id="debugInfo">Cargando información de debug...</div>
        </div>
        
        <button class="btn" onclick="logout()">Cerrar Sesión</button>
        <button class="btn" onclick="showTokenInfo()">Ver Token</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Dashboard simple cargado');
            
            // Intentar obtener datos de sesión
            let sessionData = null;
            let token = null;
            
            try {
                // Buscar en localStorage
                const storedSession = localStorage.getItem('consultorio_session');
                if (storedSession) {
                    sessionData = JSON.parse(storedSession);
                    token = sessionData.token;
                }
                
                // Si no hay en localStorage, buscar en sessionStorage
                if (!token) {
                    token = sessionStorage.getItem('auth_token');
                }
                
                console.log('Datos encontrados:', { sessionData, token: token ? 'Sí' : 'No' });
                
                // Mostrar información
                if (sessionData && sessionData.user) {
                    document.getElementById('userName').textContent = sessionData.user.name || 'N/A';
                    document.getElementById('userEmail').textContent = sessionData.user.email || 'N/A';
                    document.getElementById('userType').textContent = sessionData.user.type || 'N/A';
                } else {
                    document.getElementById('userName').textContent = 'No encontrado';
                    document.getElementById('userEmail').textContent = 'No encontrado';
                    document.getElementById('userType').textContent = 'No encontrado';
                }
                
                // Debug info
                const debugInfo = document.getElementById('debugInfo');
                debugInfo.innerHTML = `
                    <p>Token: ${token ? 'Presente (longitud: ' + token.length + ')' : 'No encontrado'}</p>
                    <p>SessionData: ${sessionData ? 'Presente' : 'No encontrado'}</p>
                    <p>LocalStorage items: ${localStorage.length}</p>
                    <p>SessionStorage items: ${sessionStorage.length}</p>
                    <p>Timestamp: ${new Date().toLocaleString()}</p>
                `;
                
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('debugInfo').innerHTML = `Error: ${error.message}`;
            }
        });
        
        function logout() {
            localStorage.removeItem('consultorio_session');
            sessionStorage.removeItem('auth_token');
            window.location.href = 'login.html';
        }
        
        function showTokenInfo() {
            const token = sessionStorage.getItem('auth_token') || 
                         (localStorage.getItem('consultorio_session') && 
                          JSON.parse(localStorage.getItem('consultorio_session')).token);
            
            if (token) {
                alert('Token encontrado (primeros 50 caracteres): ' + token.substring(0, 50) + '...');
            } else {
                alert('No se encontró token');
            }
        }
    </script>
</body>
</html>
